import{e as L,j as R,f as v,i as w,k as A,p as B,c as t,a as s,g as m,t as o,h as i,F,r as M,q as y,o as a}from"./CoqnhHP_.js";import{_ as N}from"./DlAUqK2U.js";const S={class:"search-page"},V={class:"search-title"},$={class:"search-results"},j={key:0,class:"loading"},z={key:1,class:"error"},D={key:2,class:"no-results"},J={key:0},O={key:1},Q={key:3,class:"artworks-grid"},G=["onClick"],H={class:"artwork-image"},K=["src","alt"],P={key:1,class:"placeholder-image"},T={class:"artwork-info"},W={class:"category"},X={class:"modal-gallery"},Y=["src","alt"],Z={class:"modal-info"},ee={class:"category"},se={key:0,class:"description"},te=L({__name:"search",setup(ae){const f=w(),{t:n}=R(),_=v(f.query.q||""),d=v([]),p=v(!1),h=v(null),l=v(null),c=v(0);function g(e){if(Array.isArray(e.imageUrls))return e.imageUrls;try{return typeof e.imageUrls=="string"?JSON.parse(e.imageUrls):[]}catch(r){return console.error("Erreur lors du parsing des URLs:",r),[]}}function k(e){return g(e)[0]||void 0}const I=A(()=>l.value&&g(l.value)[c.value]||void 0);function q(e){l.value=e,c.value=0}function b(){l.value=null,c.value=0}function x(){c.value>0&&c.value--}function U(){if(!l.value)return;const e=g(l.value);c.value<e.length-1&&c.value++}async function C(){if(!_.value){d.value=[];return}p.value=!0,h.value=null;try{const e=await $fetch("/api/search",{params:{q:_.value}});d.value=e.artworks,console.log("Résultats de recherche:",d.value)}catch(e){h.value=e.data?.message||n("common.error"),console.error("Erreur de recherche:",e),d.value=[]}finally{p.value=!1}}B(()=>f.query.q,e=>{_.value=e||"",C()},{immediate:!0});function E(e){const r=e.target;r.src="https://via.placeholder.com/300x200?text=Image+non+disponible",r.classList.add("error")}return(e,r)=>(a(),t("div",S,[s("h1",V,o(i(n)("search.title")),1),s("div",$,[p.value?(a(),t("div",j,[r[1]||(r[1]=s("div",{class:"loading-spinner"},null,-1)),s("p",null,o(i(n)("search.loading")),1)])):h.value?(a(),t("div",z,[s("p",null,o(h.value),1),s("button",{class:"retry-button",onClick:C},o(i(n)("common.retry")),1)])):d.value.length===0?(a(),t("div",D,[_.value?(a(),t("p",J,o(i(n)("search.empty_with_query",{query:_.value})),1)):(a(),t("p",O,o(i(n)("search.empty_without_query")),1))])):(a(),t("div",Q,[(a(!0),t(F,null,M(d.value,u=>(a(),t("div",{key:u.id,class:"artwork-card",onClick:le=>q(u)},[s("div",H,[k(u)?(a(),t("img",{key:0,src:k(u),alt:u.title,loading:"lazy",onError:E},null,40,K)):(a(),t("div",P,o(i(n)("search.image_placeholder")),1))]),s("div",T,[s("h2",null,o(u.title),1),s("p",W,o(i(n)("search.category_label",{category:u.category.name})),1)])],8,G))),128))]))]),l.value?(a(),t("div",{key:0,class:"modal",onClick:b},[s("div",{class:"modal-content",onClick:r[0]||(r[0]=y(()=>{},["stop"]))},[s("button",{class:"close-button",onClick:b},"×"),s("div",X,[s("img",{src:I.value,alt:l.value.title,class:"modal-image"},null,8,Y),c.value>0?(a(),t("button",{key:0,class:"nav-button prev",onClick:y(x,["stop"])}," < ")):m("",!0),c.value<g(l.value).length-1?(a(),t("button",{key:1,class:"nav-button next",onClick:y(U,["stop"])}," > ")):m("",!0)]),s("div",Z,[s("h2",null,o(l.value.title),1),s("p",ee,o(i(n)("search.category_label",{category:l.value.category.name})),1),l.value.description?(a(),t("p",se,o(l.value.description),1)):m("",!0)])])])):m("",!0)]))}}),ne=N(te,[["__scopeId","data-v-2b039b9f"]]);export{ne as default};
